<div class="highlight"><pre><span class="c1">## step1: build matrix</span>
n <span class="o">&amp;</span>lt<span class="p">;</span><span class="o">-</span> <span class="m">8000</span>
tmp1 <span class="o">&amp;</span>lt<span class="p">;</span><span class="o">-</span> <span class="kt">matrix</span><span class="p">(</span>rnorm<span class="p">(</span>n <span class="o">*</span> n<span class="p">),</span> nrow <span class="o">=</span> n<span class="p">,</span> ncol <span class="o">=</span> n<span class="p">)</span>
<span class="kp">gc</span><span class="p">()</span><span class="o">&lt;/</span>p<span class="o">&gt;</span>

<span class="o">&lt;</span>h2 id<span class="o">=</span><span class="s">&quot;step2-manipulate-a-subset-of-matrix&quot;</span><span class="o">&gt;</span>step2<span class="o">:</span> manipulate a subset of <span class="kt">matrix</span><span class="o">&lt;/</span>h2<span class="o">&gt;</span>
<span class="o">&lt;</span>p<span class="o">&gt;</span><span class="kp">sink</span><span class="p">(</span>‘<span class="o">/</span>dev<span class="o">/</span>null’<span class="p">)</span>
<span class="kp">apply</span><span class="p">(</span>tmp1<span class="p">[</span><span class="m">2</span><span class="o">:</span>n<span class="p">,</span> <span class="p">],</span> <span class="m">1</span><span class="p">,</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> x<span class="p">[</span><span class="m">1</span><span class="p">])</span>
<span class="kp">sink</span><span class="p">()</span><span class="o">&lt;/</span>p<span class="o">&gt;</span>

<span class="o">&lt;</span>h2 id<span class="o">=</span><span class="s">&quot;step3-garbage-collection&quot;</span><span class="o">&gt;</span>step3<span class="o">:</span> garbage collection<span class="o">&lt;/</span>h2<span class="o">&gt;</span>
<span class="o">&lt;</span>p<span class="o">&gt;</span><span class="kp">gc</span><span class="p">()</span>
</pre></div>