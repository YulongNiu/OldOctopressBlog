<div class="highlight"><pre><span class="c1">## step1: build matrix</span>
n <span class="o">&lt;-</span> <span class="m">8000</span>
tmp1 <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span>rnorm<span class="p">(</span>n <span class="o">*</span> n<span class="p">),</span> nrow <span class="o">=</span> n<span class="p">,</span> ncol <span class="o">=</span> n<span class="p">)</span>
<span class="kp">gc</span><span class="p">()</span>

<span class="c1">## step2: manipulate a subset of matrix</span>
<span class="kp">sink</span><span class="p">(</span><span class="s">&#39;/dev/null&#39;</span><span class="p">)</span>
<span class="kp">apply</span><span class="p">(</span>tmp1<span class="p">[</span><span class="m">2</span><span class="o">:</span>n<span class="p">,</span> <span class="p">],</span> <span class="m">1</span><span class="p">,</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> x<span class="p">[</span><span class="m">1</span><span class="p">])</span>
<span class="kp">sink</span><span class="p">()</span>

<span class="c1">## step3: garbage collection</span>
<span class="kp">gc</span><span class="p">()</span>
</pre></div>