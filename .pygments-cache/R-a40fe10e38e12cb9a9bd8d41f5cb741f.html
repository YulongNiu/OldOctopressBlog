<div class="highlight"><pre><span class="c1"># 载入包并且注册多核</span>
<span class="kn">library</span><span class="p">(</span>DESeq2<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>BiocParallel<span class="p">)</span>
register<span class="p">(</span>MulticoreParam<span class="p">(</span><span class="m">4</span><span class="p">))</span>

<span class="c1"># “glioPR”是一个整理好的数据框，行表示count数，列标识样本（1~10列）和注释（11~14列）。</span>
<span class="c1"># “targets”是一个数据框，表示样本的分类，注意使用因子型（factor）标记不同组</span>
<span class="o">&gt;</span> targets
        Treatment  Sample Patient
human1    primary  human1       <span class="m">1</span>
human2  recurrent  human2       <span class="m">1</span>
human3    primary  human3       <span class="m">2</span>
human4  recurrent  human4       <span class="m">2</span>
human5    primary  human5       <span class="m">3</span>
human6  recurrent  human6       <span class="m">3</span>
human7  recurrent  human7       <span class="m">4</span>
human8  recurrent  human8       <span class="m">5</span>
human9    primary  human9       <span class="m">6</span>
human10   primary human10       <span class="m">7</span>

<span class="c1"># 创建DESeqDataSet对象，使用Treatment作为比较</span>
glioPR <span class="o">&lt;-</span> DESeqDataSetFromMatrix<span class="p">(</span>countData <span class="o">=</span> htCountSelect<span class="p">[,</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">],</span> colData <span class="o">=</span> targets<span class="p">,</span> design <span class="o">=</span> <span class="o">~</span> Treatment<span class="p">)</span>
mcols<span class="p">(</span>glioPR<span class="p">)</span> <span class="o">&lt;-</span> htCountSelect<span class="p">[,</span> <span class="m">11</span><span class="o">:</span><span class="m">14</span><span class="p">]</span>

<span class="c1"># 创建DESeqDataSet对象，使用Treatment和Pateint两个因子作为比较</span>
glioPR <span class="o">&lt;-</span> DESeqDataSetFromMatrix<span class="p">(</span>countData <span class="o">=</span> htCountSelect<span class="p">[,</span> <span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">],</span> colData <span class="o">=</span> targets<span class="p">,</span> design <span class="o">=</span> <span class="o">~</span> Patient <span class="o">+</span> Treatment<span class="p">)</span>
mcols<span class="p">(</span>glioPR<span class="p">)</span> <span class="o">&lt;-</span> htCountSelect<span class="p">[,</span> <span class="m">11</span><span class="o">:</span><span class="m">14</span><span class="p">]</span>

<span class="c1"># DEGs</span>
glioPR <span class="o">&lt;-</span> DESeq<span class="p">(</span>glioPR<span class="p">)</span>
res <span class="o">&lt;-</span> results<span class="p">(</span>glioPR<span class="p">)</span>
<span class="c1">## 根据FDR值排序</span>
res<span class="p">[</span><span class="kp">order</span><span class="p">(</span>res<span class="o">$</span>padj<span class="p">),</span> <span class="p">]</span>
<span class="kp">summary</span><span class="p">(</span>res<span class="p">)</span>

<span class="c1"># 两种标准化count值方法， rlog（regularized log）和VST（variance stabilizing transformations）</span>
rld <span class="o">&lt;-</span> rlog<span class="p">(</span>glioPR<span class="p">)</span>
vsd <span class="o">&lt;-</span> varianceStabilizingTransformation<span class="p">(</span>glioPR<span class="p">)</span>
rlogMat <span class="o">&lt;-</span> assay<span class="p">(</span>rld<span class="p">)</span>
vstMat <span class="o">&lt;-</span> assay<span class="p">(</span>vsd<span class="p">)</span>
</pre></div>