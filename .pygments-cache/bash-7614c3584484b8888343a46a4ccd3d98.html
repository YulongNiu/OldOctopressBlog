<div class="highlight"><pre><span class="c"># 首先查看bam文件头部有多少行</span>
<span class="nv">$ </span>samtools view -H accepted_hits.bam <span class="p">|</span> wc -l
86

<span class="c"># 筛选成对且成功map到基因组唯一位置的reads，按照上一条输出结果，调整“NR &lt;= 86”</span>
<span class="nv">$ </span>samtools view -h accepted_hits.bam <span class="p">|</span> <span class="se">\</span>
    awk <span class="s1">&#39;{if (NR &lt;= 86) print $0}; {if($5 == 50 &amp;&amp; ($2 == 163 || $2 == 147 || $2 == 83 || $2 == 99)) print $0}&#39;</span> <span class="p">|</span> <span class="se">\</span>
    samtools view -b - &gt; accepted_filtered.bam

<span class="nv">$ </span>samtools view accepted_filtered.bam <span class="p">|</span> wc -l
79143942
</pre></div>